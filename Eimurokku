local library = loadstring(game:HttpGet(('https://raw.githubusercontent.com/AikaV3rm/UiLib/master/Lib.lua')))()

local w = library:CreateWindow("Titan Warfare")

local b = w:CreateFolder("AimLock & ESP")

local c = w:CreateFolder("Extra")

local players = game:GetService("Players")
local userInputService = game:service("UserInputService")
local VirtualUser = game:GetService("VirtualUser")
local VIM = game:GetService("VirtualInputManager")
local player = players.LocalPlayer
local Char = player.Character or player.CharacterAdded:wait()
local mouse = player:GetMouse()
local camera = game.workspace.Camera
local ESP = false
local AutoAim = false
local AimLock = false
local OnlyTargetTitans = false
local OnlyTargetHumans = false
local connection;
local TargetPosition;
local mouse2down;
local mouse2up;

function FoundTarget()
    local Target = {}
    local HRP = player.Character.HumanoidRootPart
    for _,v in pairs(game.Workspace.Objects.Characters:GetChildren()) do
        if v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 and players:FindFirstChild(v.Name).Team ~= player.Team and AimLock then
            if not OnlyTargetTitans and not OnlyTargetHumans then
                table.insert(Target,{v.HumanoidRootPart,(HRP.Position-v.HumanoidRootPart.Position).magnitude,v})
            elseif v:FindFirstChildOfClass("Model") and v:FindFirstChildOfClass("Model"):FindFirstChild("Nape") then
                if OnlyTargetTitans then
                    table.insert(Target,{v.HumanoidRootPart,(HRP.Position-v.HumanoidRootPart.Position).magnitude,v})
                end
            elseif OnlyTargetHumans then
                table.insert(Target,{v.HumanoidRootPart,(HRP.Position-v.HumanoidRootPart.Position).magnitude,v})
            end
        end
    end
    table.sort(Target,
        function(a,b)
        return a[2]<b[2]
    end)
    return Target
end
function Aim()
    local TargetInfo = FoundTarget()
    TargetPosition = camera:WorldToScreenPoint(TargetInfo[1][3].Head.Position)
    VIM:SendMouseMoveEvent(TargetPosition.X,TargetPosition.Y+30,game)
    camera.CFrame = CFrame.lookAt(camera.CFrame.Position, TargetInfo[1][3].Head.Position)
end
function esp(v)
    if v:IsA("Player") and v.Name ~= player.Name and not game.CoreGui:FindFirstChild(v.Name) and ESP then
        local billboard = Instance.new("BillboardGui")
        local textlabel = Instance.new("TextLabel") 
        local folder = Instance.new("Folder")
        billboard.Size = UDim2.new(0,100,0,150)
        billboard.StudsOffset = Vector3.new(0,1,0)
        billboard.AlwaysOnTop = true
        textlabel.Size = UDim2.new(0, 100, 0, 100)
        textlabel.Position = UDim2.new(0, 0, 0,-50)
        textlabel.TextSize = 20
        textlabel.TextStrokeTransparency = 0
        textlabel.BackgroundTransparency = 1
        textlabel.ZIndex = 1
        textlabel.Font = Enum.Font.SourceSansSemibold
        textlabel.TextYAlignment = Enum.TextYAlignment.Bottom
        folder.Name = v.Name
        folder.Parent = game.CoreGui
        billboard.Parent = folder
        textlabel.Parent = billboard
        coroutine.wrap(function()
            local playername = v.Name
            while task.wait() and ESP and game.Players:FindFirstChild(playername) do
                pcall(function()
                    if v.Team then
                        textlabel.TextColor3 = v.Team.TeamColor.Color
                    else
                        textlabel.TextColor3 = Color3.new(255,255,255)
                    end
                    billboard.Adornee = v.Character.Head
                    textlabel.Text = ("User: "..v.Name.." | Health: "..math.round(v.Character.Humanoid.Health).." | Studs: "..math.round((player.Character.HumanoidRootPart.Position-v.Character.HumanoidRootPart.Position).Magnitude))
                end)
            end
            folder:Destroy()
        end)()
    end
end
b:Toggle("AimLock",function(bool)
    AutoAim = bool
    if bool == false then return end
    mouse2down = mouse.Button2Down:Connect(function()
        if AutoAim == false then mouse2down:Disconnect() end
        if AimLock == false then
            AimLock = true
        end
    end)
    mouse2up = mouse.Button2Up:Connect(function()
        if AutoAim == false then mouse2up:Disconnect() end
        if AimLock == true then
            AimLock = false
        end
    end)
end)
b:Toggle("Player ESP",function(bool)
    ESP = bool
    if bool == false then return end
    for i,v in pairs(game.Players:GetChildren()) do
        esp(v)
    end
    connection = players.ChildAdded:Connect(function(v)
        if ESP == false then
            connection:Disconnect()
        end
        esp(v)
    end)
end)
c:Toggle("Only Target Titans",function(bool)
    OnlyTargetTitans = bool
end)
c:Toggle("Only Target Humans",function(bool)
    OnlyTargetHumans = bool
end)
c:DestroyGui()
while task.wait() do
    if AimLock then
        pcall(Aim)
    end
end
